{% extends "base.html" %}

{% block title %}Search APIs - API Explorer{% endblock %}

{% block content %}
<div class="row mb-4">
    <div class="col-12">
        <h1 class="h2 mb-1">Search APIs</h1>
        <p class="text-muted">Find APIs using different search criteria</p>
    </div>
</div>

<!-- Search Form -->
<div class="row mb-4">
    <div class="col-lg-8">
        <div class="card">
            <div class="card-body">
                <form method="GET" action="{{ url_for('search') }}">
                    <div class="row">
                        <div class="col-md-8 mb-3">
                            <label for="q" class="form-label">Search Query</label>
                            <input type="text" class="form-control" id="q" name="q" 
                                   value="{{ query }}" placeholder="Enter your search term..." required>
                        </div>
                        <div class="col-md-4 mb-3">
                            <label for="type" class="form-label">Search Type</label>
                            <select class="form-select" id="type" name="type">
                                <option value="name" {% if search_type == 'name' %}selected{% endif %}>By Name</option>
                                <option value="tag" {% if search_type == 'tag' %}selected{% endif %}>By Tag</option>
                                <option value="use_case" {% if search_type == 'use_case' %}selected{% endif %}>By Use Case</option>
                            </select>
                        </div>
                    </div>
                    <div>
                        <button type="submit" class="btn btn-primary">
                            <i class="fas fa-search me-2"></i>Search
                        </button>
                    </div>
                </form>
            </div>
        </div>
    </div>
</div>

<!-- Search Results -->
{% if query %}
<div class="row mb-4">
    <div class="col-12">
        <h3>Search Results</h3>
        <p class="text-muted">
            Found {{ results|length }} result{% if results|length != 1 %}s{% endif %} for 
            "{{ query }}" in {{ search_type.replace('_', ' ') }} search
        </p>
    </div>
</div>

{% if results %}
<div class="row">
    <div class="col-12">
        <div class="card">
            <div class="card-body p-0">
                <div class="table-responsive">
                    <table class="table table-hover mb-0">
                        <thead>
                            <tr>
                                <th>Name</th>
                                <th>Description</th>
                                <th>Tags</th>
                                <th>Base URL</th>
                                <th>Pricing</th>
                                <th></th>
                            </tr>
                        </thead>
                        <tbody>
                            {% for api in results %}
                            <tr>
                                <td>
                                    <strong>{{ api.name }}</strong>
                                </td>
                                <td>{{ api.description[:80] }}{% if api.description|length > 80 %}...{% endif %}</td>
                                <td>
                                    {% for tag in api.tags[:3] %}
                                    <span class="badge me-1">{{ tag }}</span>
                                    {% endfor %}
                                </td>
                                <td>
                                    <code class="small">{{ api.base_url|truncate(25) }}</code>
                                </td>
                                <td>
                                    {% if 'free' in api.pricing.lower() %}
                                    <span class="badge bg-success">Free</span>
                                    {% else %}
                                    <span class="badge bg-warning">Paid</span>
                                    {% endif %}
                                </td>
                                <td>
                                    <a href="{{ url_for('api_detail', api_id=api.id) }}" class="btn btn-sm btn-outline-primary">
                                        View
                                    </a>
                                </td>
                            </tr>
                            {% endfor %}
                        </tbody>
                    </table>
                </div>
            </div>
        </div>
    </div>
</div>
{% else %}
<div class="row">
    <div class="col-12 text-center">
        <div class="card">
            <div class="card-body py-5">
                <i class="fas fa-search fa-3x text-muted mb-3"></i>
                <h4>No Results Found</h4>
                <p class="text-muted">Try adjusting your search query or search type.</p>
                <div class="mt-3">
                    <a href="{{ url_for('search') }}" class="btn btn-primary me-2">New Search</a>
                    <a href="{{ url_for('list_apis') }}" class="btn btn-outline-primary">Browse All APIs</a>
                </div>
            </div>
        </div>
    </div>
</div>
{% endif %}
{% endif %}

<!-- Search Tips -->
<div class="row mt-4">
    <div class="col-lg-8">
        <div class="card">
            <div class="card-header">
                <h5 class="mb-0"><i class="fas fa-lightbulb me-2"></i>Search Tips</h5>
            </div>
            <div class="card-body">
                <div class="row">
                    <div class="col-md-4 text-center mb-3">
                        <i class="fas fa-tag fa-2x text-primary mb-2"></i>
                        <h6>Search by Tag</h6>
                        <p class="text-muted small">Use tags like "weather", "news", or "images"</p>
                    </div>
                    <div class="col-md-4 text-center mb-3">
                        <i class="fas fa-search fa-2x text-primary mb-2"></i>
                        <h6>Search by Name</h6>
                        <p class="text-muted small">Partial name matches work</p>
                    </div>
                    <div class="col-md-4 text-center mb-3">
                        <i class="fas fa-tasks fa-2x text-primary mb-2"></i>
                        <h6>Search by Use Case</h6>
                        <p class="text-muted small">Find APIs for specific applications</p>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
{% endblock %}
